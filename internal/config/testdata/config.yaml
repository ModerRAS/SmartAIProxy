server:
  listen: "0.0.0.0:8080"
  timeout: 30
  max_connections: 1000
  enable_https: false
  cert_file: ""
  key_file: ""

log:
  level: "info"
  file: "./logs/server.log"
  max_size: 20
  max_backups: 5
  max_age: 30

admin:
  enable: true
  listen: "127.0.0.1:9090"
  username: "admin"
  password: "password"

channels:
  - name: "免费渠道A"
    type: "openai"
    endpoint: "https://api.openai.com/v1"
    api_key: "sk-free"
    price_per_token: 0
    daily_limit: 10000
    hour_limit: 1000
    priority: 1

  - name: "夜间折扣渠道B"
    type: "claude"
    endpoint: "https://api.anthropic.com/v1"
    api_key: "claude-night"
    price_per_token: 0.005
    discount_time: ["00:00-06:00"]
    discount_price: 0.002
    priority: 2

  - name: "普通付费渠道C"
    type: "openai"
    endpoint: "https://api.openai.com/v1"
    api_key: "sk-paid"
    price_per_token: 0.01
    priority: 3

rules:
  - name: "免费优先"
    channel: "免费渠道A"
    expression: "day_tokens_used < daily_limit && hour_tokens_used < hour_limit"

  - name: "夜间折扣优先"
    channel: "夜间折扣渠道B"
    expression: "time >= '00:00' && time <= '06:00'"

  - name: "最便宜优先"
    channel: "普通付费渠道C"
    expression: "true"

error_handling:
  check_output_complete: true
  retry_on_incomplete: 2
  return_standard_error: true

monitor:
  enable: true
  prometheus_listen: "0.0.0.0:9100"
